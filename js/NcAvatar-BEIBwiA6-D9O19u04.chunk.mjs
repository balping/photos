import{B as At,a9 as Mt,aa as It,f as kt,q as Z,g as D,ag as Ut,w as U,e as V,N as ft,a0 as J,ah as Dt,ab as Lt,u as Nt,_ as gt,ad as Bt,s as X,z as E,A as O}from"./vue.runtime.esm-zA5QjVAQ.chunk.mjs";import{a as L,r as q,ai as qt,aj as Pt,f as y,P as R,i as A,ak as Et,v as Ot,al as zt,am as $t,an as Ht,ao as Gt,x as Wt,E as Xt,m as jt,A as Ft,ap as Zt}from"./index-CSC-o6Za.chunk.mjs";import{a as Y,N as Vt}from"./NcActionButton-DC3oAI2L-DJi63ibN.chunk.mjs";import{e as vt}from"./index-PNtmEpku.chunk.mjs";import{l as Rt}from"./video-Dae3ElHF.chunk.mjs";function mt(t){return Mt()?(It(t),!0):!1}function C(t){return typeof t=="function"?t():At(t)}const K={mounted:"inserted",unmounted:"unbind"},yt=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Yt=Object.prototype.toString,Jt=t=>Yt.call(t)==="[object Object]",k=()=>{},j=Kt();function Kt(){var t,e;return yt&&((t=window?.navigator)==null?void 0:t.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window?.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window?.navigator.userAgent))}function Qt(...t){if(t.length!==1)return kt(...t);const e=t[0];return typeof e=="function"?Z(Ut(()=>({get:e,set:k}))):D(e)}const wt=yt?window:void 0;function I(t){var e;const s=C(t);return(e=s?.$el)!=null?e:s}function N(...t){let e,s,a,l;if(typeof t[0]=="string"||Array.isArray(t[0])?([s,a,l]=t,e=wt):[e,s,a,l]=t,!e)return k;Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]);const p=[],f=()=>{p.forEach(r=>r()),p.length=0},o=(r,i,c,u)=>(r.addEventListener(i,c,u),()=>r.removeEventListener(i,c,u)),v=U(()=>[I(e),C(l)],([r,i])=>{if(f(),!r)return;const c=Jt(i)?{...i}:i;p.push(...s.flatMap(u=>a.map(d=>o(r,u,d,c))))},{immediate:!0,flush:"post"}),n=()=>{v(),f()};return mt(n),n}let Q=!1;function tt(t,e,s={}){const{window:a=wt,ignore:l=[],capture:p=!0,detectIframe:f=!1}=s;if(!a)return k;j&&!Q&&(Q=!0,Array.from(a.document.body.children).forEach(d=>d.addEventListener("click",k)),a.document.documentElement.addEventListener("click",k));let o=!0;const v=d=>C(l).some(h=>{if(typeof h=="string")return Array.from(a.document.querySelectorAll(h)).some(g=>g===d.target||d.composedPath().includes(g));{const g=I(h);return g&&(d.target===g||d.composedPath().includes(g))}});function n(d){const h=C(d);return h&&h.$.subTree.shapeFlag===16}function r(d,h){const g=C(d),m=g.$.subTree&&g.$.subTree.children;return m==null||!Array.isArray(m)?!1:m.some(_=>_.el===h.target||h.composedPath().includes(_.el))}const i=d=>{const h=I(t);if(d.target!=null&&!(!(h instanceof Element)&&n(t)&&r(t,d))&&!(!h||h===d.target||d.composedPath().includes(h))){if(d.detail===0&&(o=!v(d)),!o){o=!0;return}e(d)}};let c=!1;const u=[N(a,"click",d=>{c||(c=!0,setTimeout(()=>{c=!1},0),i(d))},{passive:!0,capture:p}),N(a,"pointerdown",d=>{const h=I(t);o=!v(d)&&!!(h&&!d.composedPath().includes(h))},{passive:!0}),f&&N(a,"blur",d=>{setTimeout(()=>{var h;const g=I(t);((h=a.document.activeElement)==null?void 0:h.tagName)==="IFRAME"&&!g?.contains(a.document.activeElement)&&e(d)},0)})].filter(Boolean);return()=>u.forEach(d=>d())}const te={[K.mounted](t,e){const s=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=tt(t,e.value,{capture:s});else{const[a,l]=e.value;t.__onClickOutside_stop=tt(t,a,Object.assign({capture:s},l))}},[K.unmounted](t){t.__onClickOutside_stop()}};function z(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function St(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const s=t.parentNode;return!s||s.tagName==="BODY"?!1:St(s)}}function ee(t){const e=t||window.event,s=e.target;return St(s)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const $=new WeakMap;function se(t,e=!1){const s=D(e);let a=null,l="";U(Qt(t),o=>{const v=z(C(o));if(v){const n=v;if($.get(n)||$.set(n,n.style.overflow),n.style.overflow!=="hidden"&&(l=n.style.overflow),n.style.overflow==="hidden")return s.value=!0;if(s.value)return n.style.overflow="hidden"}},{immediate:!0});const p=()=>{const o=z(C(t));!o||s.value||(j&&(a=N(o,"touchmove",v=>{ee(v)},{passive:!1})),o.style.overflow="hidden",s.value=!0)},f=()=>{const o=z(C(t));!o||!s.value||(j&&a?.(),o.style.overflow=l,$.delete(o),s.value=!1)};return mt(f),V({get(){return s.value},set(o){o?p():f()}})}function ne(){let t=!1;const e=D(!1);return(s,a)=>{if(e.value=a.value,t)return;t=!0;const l=se(s,a.value);U(e,p=>l.value=p)}}ne();const ae={name:"NcActionLink",mixins:[Y],inject:{isInSemanticMenu:{from:"NcActions:isSemanticMenu",default:!1}},props:{href:{type:String,default:"#",required:!0,validator:t=>{try{return new URL(t)}catch{return t.startsWith("#")||t.startsWith("/")}}},download:{type:String,default:null},target:{type:String,default:"_self",validator:t=>t&&(!t.startsWith("_")||["_blank","_self","_parent","_top"].indexOf(t)>-1)},title:{type:String,default:null},ariaHidden:{type:Boolean,default:null}}};var re=function(){var t=this,e=t._self._c;return e("li",{staticClass:"action",attrs:{role:t.isInSemanticMenu&&"presentation"}},[e("a",{staticClass:"action-link focusable",attrs:{download:t.download,href:t.href,"aria-label":t.ariaLabel,target:t.target,title:t.title,rel:"nofollow noreferrer noopener",role:t.isInSemanticMenu&&"menuitem"},on:{click:t.onClick}},[t._t("icon",function(){return[e("span",{staticClass:"action-link__icon",class:[t.isIconUrl?"action-link__icon--url":t.icon],style:{backgroundImage:t.isIconUrl?`url(${t.icon})`:null},attrs:{"aria-hidden":"true"}})]}),t.name?e("span",{staticClass:"action-link__longtext-wrapper"},[e("strong",{staticClass:"action-link__name"},[t._v(" "+t._s(t.name)+" ")]),e("br"),e("span",{staticClass:"action-link__longtext",domProps:{textContent:t._s(t.text)}})]):t.isLongText?e("span",{staticClass:"action-link__longtext",domProps:{textContent:t._s(t.text)}}):e("span",{staticClass:"action-link__text"},[t._v(t._s(t.text))]),t._e()],2)])},oe=[],ie=L(ae,re,oe,!1,null,"30c015f0");const ce=ie.exports,le={name:"NcActionRouter",mixins:[Y],inject:{isInSemanticMenu:{from:"NcActions:isSemanticMenu",default:!1}},props:{to:{type:[String,Object],default:"",required:!0},exact:{type:Boolean,default:!1}}};var ue=function(){var t=this,e=t._self._c;return e("li",{staticClass:"action",attrs:{role:t.isInSemanticMenu&&"presentation"}},[e("RouterLink",{staticClass:"action-router focusable",attrs:{to:t.to,"aria-label":t.ariaLabel,exact:t.exact,title:t.title,rel:"nofollow noreferrer noopener",role:t.isInSemanticMenu&&"menuitem"},nativeOn:{click:function(s){return t.onClick.apply(null,arguments)}}},[t._t("icon",function(){return[e("span",{staticClass:"action-router__icon",class:[t.isIconUrl?"action-router__icon--url":t.icon],style:{backgroundImage:t.isIconUrl?`url(${t.icon})`:null},attrs:{"aria-hidden":"true"}})]}),t.name?e("span",{staticClass:"action-router__longtext-wrapper"},[e("strong",{staticClass:"action-router__name"},[t._v(" "+t._s(t.name)+" ")]),e("br"),e("span",{staticClass:"action-router__longtext",domProps:{textContent:t._s(t.text)}})]):t.isLongText?e("span",{staticClass:"action-router__longtext",domProps:{textContent:t._s(t.text)}}):e("span",{staticClass:"action-router__text"},[t._v(t._s(t.text))]),t._e()],2)],1)},de=[],he=L(le,ue,de,!1,null,"579c6b4d");const pe=he.exports,fe={name:"NcActionText",mixins:[Y],inject:{isInSemanticMenu:{from:"NcActions:isSemanticMenu",default:!1}}};var ge=function(){var t=this,e=t._self._c;return e("li",{staticClass:"action",attrs:{role:t.isInSemanticMenu&&"presentation"}},[e("span",{staticClass:"action-text",on:{click:t.onClick}},[t._t("icon",function(){return[t.icon!==""?e("span",{staticClass:"action-text__icon",class:[t.isIconUrl?"action-text__icon--url":t.icon],style:{backgroundImage:t.isIconUrl?`url(${t.icon})`:null},attrs:{"aria-hidden":"true"}}):t._e()]}),t.name?e("span",{staticClass:"action-text__longtext-wrapper"},[e("strong",{staticClass:"action-text__name"},[t._v(" "+t._s(t.name)+" ")]),e("span",{staticClass:"action-text__longtext",domProps:{textContent:t._s(t.text)}})]):t.isLongText?e("span",{staticClass:"action-text__longtext",domProps:{textContent:t._s(t.text)}}):e("span",{staticClass:"action-text__text"},[t._v(t._s(t.text))]),t._e()],2)])},ve=[],me=L(fe,ge,ve,!1,null,"6a01d6d2");const ye=me.exports,we=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="0 -960 960 960" width="24px" height="24px" xmlns="http://www.w3.org/2000/svg">
	<path
		fill="var(--user-status-color-online, var(--color-success, #2D7B41))"
		d="m424-296 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z"/>
</svg>
`,Se=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="-1 -1 18 18" width="16" height="16" xmlns="http://www.w3.org/2000/svg">
	<path fill="var(--color-success)" d="M4.8 11.2h6.4V4.8H4.8v6.4zM8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8z" />
</svg>
`,_e=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="0 -960 960 960" width="24px" height="24px" xmlns="http://www.w3.org/2000/svg">
	<path
		fill="var(--user-status-color-away, var(--color-warning, #C88800))"
		d="m612-292 56-56-148-148v-184h-80v216l172 172ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z"/>
</svg>
`,et=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="-1 -1 18 18" width="16" height="16" xmlns="http://www.w3.org/2000/svg">
	<path fill="none" d="M-4-4h24v24H-4z" />
	<path fill="var(--color-warning)" d="M6.9.1C3 .6-.1 4-.1 8c0 4.4 3.6 8 8 8 4 0 7.4-3 8-6.9-1.2 1.3-2.9 2.1-4.7 2.1-3.5 0-6.4-2.9-6.4-6.4 0-1.9.8-3.6 2.1-4.7z" />
</svg>
`,xe=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="0 -960 960 960" width="24px" height="24px" xmlns="http://www.w3.org/2000/svg">
	<path
		fill="var(--user-status-color-busy, var(--color-error, #DB0606))"
		d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z"/>
</svg>
`,be=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="0 -960 960 960" width="24px" height="24px" xmlns="http://www.w3.org/2000/svg">
	<path
		fill="var(--user-status-color-busy, var(--color-error, #DB0606))"
		d="M280-440h400v-80H280v80ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Z"/>
</svg>
`,Ce=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="-1 -1 18 18" width="16" height="16" xmlns="http://www.w3.org/2000/svg">
	<path fill="none" d="M-4-4h24v24H-4V-4z" />
	<path fill="var(--color-border-error, var(--color-error))" d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8z" />
	<path fill="#fdffff" d="M5 6.5h6c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5H5c-.8 0-1.5-.7-1.5-1.5S4.2 6.5 5 6.5z" />
</svg>
`,st=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="0 -960 960 960" width="24px" height="24px" xmlns="http://www.w3.org/2000/svg">
	<path
		fill="var(--user-status-color-offline, var(--color-text-maxcontrast, #6B6B6B))"
		d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/>
</svg>
`,nt=`<!--
  - SPDX-FileCopyrightText: 2020 Google Inc.
  - SPDX-License-Identifier: Apache-2.0
-->
<svg viewBox="-1 -1 18 18" width="16" height="16" xmlns="http://www.w3.org/2000/svg">
	<path fill="none" d="M-4-4h24v24H-4V-4z" />
	<path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm0 3.2c2.7 0 4.8 2.1 4.8 4.8s-2.1 4.8-4.8 4.8S3.2 10.7 3.2 8 5.3 3.2 8 3.2z" />
</svg>
`;q(qt);const _t=t=>{switch(t){case"away":return y("away");case"busy":return y("busy");case"dnd":return y("do not disturb");case"online":return y("online");case"invisible":return y("invisible");case"offline":return y("offline");default:return t}};q(Pt);const Te={online:A?Se:we,away:A?et:_e,busy:A?et:xe,dnd:A?Ce:be,invisible:A?nt:st,offline:A?nt:st},Ae={name:"NcUserStatusIcon",props:{user:{type:String,default:null},status:{type:String,default:null,validator:t=>["online","away","busy","dnd","invisible","offline"].includes(t)},ariaHidden:{type:String,default:null,validator:t=>["true","false"].includes(t)}},data(){return{fetchedUserStatus:null}},computed:{activeStatus(){return this.status??this.fetchedUserStatus},activeSvg(){return Te[this.activeStatus]??null},ariaLabel(){return this.ariaHidden==="true"?null:y("User status: {status}",{status:_t(this.activeStatus)})}},watch:{user:{immediate:!0,async handler(t,e){if(!t||!vt()?.user_status?.enabled){this.fetchedUserStatus=null;return}try{const{data:s}=await R.get(ft("/apps/user_status/api/v1/statuses/{user}",{user:t}));this.fetchedUserStatus=s.ocs?.data?.status}catch{this.fetchedUserStatus=null}}}}};var Me=function(){var t=this,e=t._self._c;return t.activeStatus?e("span",{staticClass:"user-status-icon",class:{"user-status-icon--invisible":["invisible","offline"].includes(t.status)},attrs:{role:"img","aria-hidden":t.ariaHidden,"aria-label":t.ariaLabel},domProps:{innerHTML:t._s(t.activeSvg)}}):t._e()},Ie=[],ke=L(Ae,Me,Ie,!1,null,"02786ab5");const Ue=ke.exports,De=(t,e)=>{const s=(r,i)=>r.startsWith(i)?r.slice(i.length):r,a=(r,...i)=>i.reduce((c,u)=>s(c,u),r);if(!t)return null;const l=/^https?:\/\//.test(e),p=/^[a-z][a-z0-9+.-]*:.+/.test(e);if(!l&&p||l&&!e.startsWith(J())||!l&&!e.startsWith("/"))return null;const f=l?a(e,J(),"/index.php"):e,o=a(t.history.base,Dt(),"/index.php"),v=a(f,o)||"/",n=t.resolve(v).route;return n.matched.length?n.fullPath:null};function B(t=document.body){const e=window.getComputedStyle(t).getPropertyValue("--background-invert-if-dark");return e!==void 0?e==="invert(100%)":!1}B();const Le=Symbol.for("nc:theme:enforced");function Ne(t){const e=V(()=>Ot(t)??document.body),s=D(B(e.value)),a=zt();function l(){s.value=B(e.value)}return $t(e,l,{attributes:!0}),U(e,l),U(a,l,{immediate:!0}),Z(s)}const Be=Et(()=>Ne());function qe(){const t=Be(),e=Lt(Le,void 0);return V(()=>e?.value?e.value==="dark":t.value)}q(Ht);class S{constructor(e,s,a,l){this.r=e,this.g=s,this.b=a,l&&(this.name=l)}get color(){const e=s=>`00${s.toString(16)}`.slice(-2);return`#${e(this.r)}${e(this.g)}${e(this.b)}`}}function Pe(t,e){const s=new Array(3);return s[0]=(e[1].r-e[0].r)/t,s[1]=(e[1].g-e[0].g)/t,s[2]=(e[1].b-e[0].b)/t,s}function H(t,e,s){const a=[];a.push(e);const l=Pe(t,[e,s]);for(let p=1;p<t;p++){const f=Math.floor(e.r+l[0]*p),o=Math.floor(e.g+l[1]*p),v=Math.floor(e.b+l[2]*p);a.push(new S(f,o,v))}return a}const as=[new S(182,70,157,y("Purple")),new S(191,103,139,y("Rosy brown")),new S(201,136,121,y("Feldspar")),new S(211,169,103,y("Whiskey")),new S(221,203,85,y("Gold")),new S(165,184,114,y("Olivine")),new S(110,166,143,y("Acapulco")),new S(55,148,172,y("Boston Blue")),new S(0,130,201,y("Nextcloud blue")),new S(45,115,190,y("Mariner")),new S(91,100,179,y("Blue Violet")),new S(136,85,168,y("Deluge"))];function Ee(t){const e=new S(182,70,157,y("Purple")),s=new S(221,203,85,y("Gold")),a=new S(0,130,201,y("Nextcloud blue")),l=H(t,e,s),p=H(t,s,a),f=H(t,a,e);return l.concat(p).concat(f)}var at={exports:{}},rt={exports:{}},ot;function Oe(){return ot||(ot=1,function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(s,a){return s<<a|s>>>32-a},rotr:function(s,a){return s<<32-a|s>>>a},endian:function(s){if(s.constructor==Number)return e.rotl(s,8)&16711935|e.rotl(s,24)&4278255360;for(var a=0;a<s.length;a++)s[a]=e.endian(s[a]);return s},randomBytes:function(s){for(var a=[];s>0;s--)a.push(Math.floor(Math.random()*256));return a},bytesToWords:function(s){for(var a=[],l=0,p=0;l<s.length;l++,p+=8)a[p>>>5]|=s[l]<<24-p%32;return a},wordsToBytes:function(s){for(var a=[],l=0;l<s.length*32;l+=8)a.push(s[l>>>5]>>>24-l%32&255);return a},bytesToHex:function(s){for(var a=[],l=0;l<s.length;l++)a.push((s[l]>>>4).toString(16)),a.push((s[l]&15).toString(16));return a.join("")},hexToBytes:function(s){for(var a=[],l=0;l<s.length;l+=2)a.push(parseInt(s.substr(l,2),16));return a},bytesToBase64:function(s){for(var a=[],l=0;l<s.length;l+=3)for(var p=s[l]<<16|s[l+1]<<8|s[l+2],f=0;f<4;f++)l*8+f*6<=s.length*8?a.push(t.charAt(p>>>6*(3-f)&63)):a.push("=");return a.join("")},base64ToBytes:function(s){s=s.replace(/[^A-Z0-9+\/]/ig,"");for(var a=[],l=0,p=0;l<s.length;p=++l%4)p!=0&&a.push((t.indexOf(s.charAt(l-1))&Math.pow(2,-2*p+8)-1)<<p*2|t.indexOf(s.charAt(l))>>>6-p*2);return a}};rt.exports=e}()),rt.exports}var G,it;function ct(){if(it)return G;it=1;var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var s=[],a=0;a<e.length;a++)s.push(e.charCodeAt(a)&255);return s},bytesToString:function(e){for(var s=[],a=0;a<e.length;a++)s.push(String.fromCharCode(e[a]));return s.join("")}}};return G=t,G}var W,lt;function ze(){if(lt)return W;lt=1,W=function(s){return s!=null&&(t(s)||e(s)||!!s._isBuffer)};function t(s){return!!s.constructor&&typeof s.constructor.isBuffer=="function"&&s.constructor.isBuffer(s)}function e(s){return typeof s.readFloatLE=="function"&&typeof s.slice=="function"&&t(s.slice(0,0))}return W}var ut;function $e(){return ut||(ut=1,function(){var t=Oe(),e=ct().utf8,s=ze(),a=ct().bin,l=function(p,f){p.constructor==String?f&&f.encoding==="binary"?p=a.stringToBytes(p):p=e.stringToBytes(p):s(p)?p=Array.prototype.slice.call(p,0):!Array.isArray(p)&&p.constructor!==Uint8Array&&(p=p.toString());for(var o=t.bytesToWords(p),v=p.length*8,n=1732584193,r=-271733879,i=-1732584194,c=271733878,u=0;u<o.length;u++)o[u]=(o[u]<<8|o[u]>>>24)&16711935|(o[u]<<24|o[u]>>>8)&4278255360;o[v>>>5]|=128<<v%32,o[(v+64>>>9<<4)+14]=v;for(var d=l._ff,h=l._gg,g=l._hh,m=l._ii,u=0;u<o.length;u+=16){var _=n,w=r,T=i,b=c;n=d(n,r,i,c,o[u+0],7,-680876936),c=d(c,n,r,i,o[u+1],12,-389564586),i=d(i,c,n,r,o[u+2],17,606105819),r=d(r,i,c,n,o[u+3],22,-1044525330),n=d(n,r,i,c,o[u+4],7,-176418897),c=d(c,n,r,i,o[u+5],12,1200080426),i=d(i,c,n,r,o[u+6],17,-1473231341),r=d(r,i,c,n,o[u+7],22,-45705983),n=d(n,r,i,c,o[u+8],7,1770035416),c=d(c,n,r,i,o[u+9],12,-1958414417),i=d(i,c,n,r,o[u+10],17,-42063),r=d(r,i,c,n,o[u+11],22,-1990404162),n=d(n,r,i,c,o[u+12],7,1804603682),c=d(c,n,r,i,o[u+13],12,-40341101),i=d(i,c,n,r,o[u+14],17,-1502002290),r=d(r,i,c,n,o[u+15],22,1236535329),n=h(n,r,i,c,o[u+1],5,-165796510),c=h(c,n,r,i,o[u+6],9,-1069501632),i=h(i,c,n,r,o[u+11],14,643717713),r=h(r,i,c,n,o[u+0],20,-373897302),n=h(n,r,i,c,o[u+5],5,-701558691),c=h(c,n,r,i,o[u+10],9,38016083),i=h(i,c,n,r,o[u+15],14,-660478335),r=h(r,i,c,n,o[u+4],20,-405537848),n=h(n,r,i,c,o[u+9],5,568446438),c=h(c,n,r,i,o[u+14],9,-1019803690),i=h(i,c,n,r,o[u+3],14,-187363961),r=h(r,i,c,n,o[u+8],20,1163531501),n=h(n,r,i,c,o[u+13],5,-1444681467),c=h(c,n,r,i,o[u+2],9,-51403784),i=h(i,c,n,r,o[u+7],14,1735328473),r=h(r,i,c,n,o[u+12],20,-1926607734),n=g(n,r,i,c,o[u+5],4,-378558),c=g(c,n,r,i,o[u+8],11,-2022574463),i=g(i,c,n,r,o[u+11],16,1839030562),r=g(r,i,c,n,o[u+14],23,-35309556),n=g(n,r,i,c,o[u+1],4,-1530992060),c=g(c,n,r,i,o[u+4],11,1272893353),i=g(i,c,n,r,o[u+7],16,-155497632),r=g(r,i,c,n,o[u+10],23,-1094730640),n=g(n,r,i,c,o[u+13],4,681279174),c=g(c,n,r,i,o[u+0],11,-358537222),i=g(i,c,n,r,o[u+3],16,-722521979),r=g(r,i,c,n,o[u+6],23,76029189),n=g(n,r,i,c,o[u+9],4,-640364487),c=g(c,n,r,i,o[u+12],11,-421815835),i=g(i,c,n,r,o[u+15],16,530742520),r=g(r,i,c,n,o[u+2],23,-995338651),n=m(n,r,i,c,o[u+0],6,-198630844),c=m(c,n,r,i,o[u+7],10,1126891415),i=m(i,c,n,r,o[u+14],15,-1416354905),r=m(r,i,c,n,o[u+5],21,-57434055),n=m(n,r,i,c,o[u+12],6,1700485571),c=m(c,n,r,i,o[u+3],10,-1894986606),i=m(i,c,n,r,o[u+10],15,-1051523),r=m(r,i,c,n,o[u+1],21,-2054922799),n=m(n,r,i,c,o[u+8],6,1873313359),c=m(c,n,r,i,o[u+15],10,-30611744),i=m(i,c,n,r,o[u+6],15,-1560198380),r=m(r,i,c,n,o[u+13],21,1309151649),n=m(n,r,i,c,o[u+4],6,-145523070),c=m(c,n,r,i,o[u+11],10,-1120210379),i=m(i,c,n,r,o[u+2],15,718787259),r=m(r,i,c,n,o[u+9],21,-343485551),n=n+_>>>0,r=r+w>>>0,i=i+T>>>0,c=c+b>>>0}return t.endian([n,r,i,c])};l._ff=function(p,f,o,v,n,r,i){var c=p+(f&o|~f&v)+(n>>>0)+i;return(c<<r|c>>>32-r)+f},l._gg=function(p,f,o,v,n,r,i){var c=p+(f&v|o&~v)+(n>>>0)+i;return(c<<r|c>>>32-r)+f},l._hh=function(p,f,o,v,n,r,i){var c=p+(f^o^v)+(n>>>0)+i;return(c<<r|c>>>32-r)+f},l._ii=function(p,f,o,v,n,r,i){var c=p+(o^(f|~v))+(n>>>0)+i;return(c<<r|c>>>32-r)+f},l._blocksize=16,l._digestsize=16,at.exports=function(p,f){if(p==null)throw new Error("Illegal argument "+p);var o=t.wordsToBytes(l(p,f));return f&&f.asBytes?o:f&&f.asString?a.bytesToString(o):t.bytesToHex(o)}}()),at.exports}var He=$e();const Ge=Nt(He);function dt(t){let e=t.toLowerCase();e.match(/^([0-9a-f]{4}-?){8}$/)===null&&(e=Ge(e)),e=e.replace(/[^0-9a-f]/g,"");const s=6,a=Ee(s);function l(p,f){let o=0;const v=[];for(let n=0;n<p.length;n++)v.push(parseInt(p.charAt(n),16)%16);for(const n in v)o+=v[n];return parseInt(parseInt(o,10)%f,10)}return a[l(e,s*3)]}function We(t){return window._nc_contacts_menu_hooks?Object.values(window._nc_contacts_menu_hooks).filter(e=>e.enabled(t)):[]}const xt=D(bt());window.addEventListener("resize",()=>{xt.value=bt()});function bt(){return window.outerHeight===window.screen.height}Z(xt);function Xe(t,e){const s=(e?.size||64)<=64?64:512,a=e?.isGuest?"/guest":"",l=e?.isDarkTheme??B(document.body)?"/dark":"";return gt(`/avatar${a}/{user}/{size}${l}`,{user:t,size:s})}var F={exports:{}},je=F.exports,ht;function Fe(){return ht||(ht=1,function(t){(function(e){if(typeof s!="function"){var s=function(d){return d};s.nonNative=!0}const a=s("plaintext"),l=s("html"),p=s("comment"),f=/<(\w*)>/g,o=/<\/?([^\s\/>]+)/;function v(d,h,g){d=d||"",h=h||[],g=g||"";let m=r(h,g);return i(d,m)}function n(d,h){d=d||[],h=h||"";let g=r(d,h);return function(m){return i(m||"",g)}}v.init_streaming_mode=n;function r(d,h){return d=c(d),{allowable_tags:d,tag_replacement:h,state:a,tag_buffer:"",depth:0,in_quote_char:""}}function i(d,h){if(typeof d!="string")throw new TypeError("'html' parameter must be a string");let g=h.allowable_tags,m=h.tag_replacement,_=h.state,w=h.tag_buffer,T=h.depth,b=h.in_quote_char,M="";for(let P=0,Tt=d.length;P<Tt;P++){let x=d[P];if(_===a)switch(x){case"<":_=l,w+=x;break;default:M+=x;break}else if(_===l)switch(x){case"<":if(b)break;T++;break;case">":if(b)break;if(T){T--;break}b="",_=a,w+=">",g.has(u(w))?M+=w:M+=m,w="";break;case'"':case"'":x===b?b="":b=b||x,w+=x;break;case"-":w==="<!-"&&(_=p),w+=x;break;case" ":case`
`:if(w==="<"){_=a,M+="< ",w="";break}w+=x;break;default:w+=x;break}else if(_===p)switch(x){case">":w.slice(-2)=="--"&&(_=a),w="";break;default:w+=x;break}}return h.state=_,h.tag_buffer=w,h.depth=T,h.in_quote_char=b,M}function c(d){let h=new Set;if(typeof d=="string"){let g;for(;g=f.exec(d);)h.add(g[1])}else!s.nonNative&&typeof d[s.iterator]=="function"?h=new Set(d):typeof d.forEach=="function"&&d.forEach(h.add,h);return h}function u(d){let h=o.exec(d);return h?h[1].toLowerCase():null}t.exports?t.exports=v:e.striptags=v})(je)}(F)),F.exports}Fe();const Ze={data(){return{hasStatus:!1,userStatus:{status:null,message:null,icon:null}}},methods:{async fetchUserStatus(t){if(!t)return;const e=vt();if(!(!Object.prototype.hasOwnProperty.call(e,"user_status")||!e.user_status.enabled)&&X())try{const{data:s}=await R.get(ft("apps/user_status/api/v1/statuses/{userId}",{userId:t})),{status:a,message:l,icon:p}=s.ocs.data;this.userStatus.status=a,this.userStatus.message=l||"",this.userStatus.icon=p||"",this.hasStatus=!0}catch(s){if(s.response.status===404&&s.response.data.ocs?.data?.length===0)return;console.error(s)}}}};q(Gt);const Ct=Bt.getBuilder("nextcloud").persist().build();function Ve(t){const e=Ct.getItem("user-has-avatar."+t);return typeof e=="string"?!!e:null}function pt(t,e){t&&Ct.setItem("user-has-avatar."+t,e)}const Re={name:"NcAvatar",directives:{ClickOutside:te},components:{IconDotsHorizontal:Zt,NcActions:Ft,NcButton:jt,NcIconSvgWrapper:Xt,NcLoadingIcon:Wt,NcUserStatusIcon:Ue},mixins:[Ze],props:{url:{type:String,default:void 0},iconClass:{type:String,default:void 0},user:{type:String,default:void 0},hideStatus:{type:Boolean,default:!1},showUserStatus:{type:Boolean,default:!0},verboseStatus:{type:Boolean,default:!1},showUserStatusCompact:{type:Boolean,default:!0},preloadedUserStatus:{type:Object,default:void 0},isGuest:{type:Boolean,default:!1},displayName:{type:String,default:void 0},size:{type:Number,default:32},noPlaceholder:{type:Boolean,default:!1},allowPlaceholder:{type:Boolean,default:!0},disableTooltip:{type:Boolean,default:!1},disableMenu:{type:Boolean,default:!1},tooltipMessage:{type:String,default:null},isNoUser:{type:Boolean,default:!1},menuContainer:{type:[String,Object,Element,Boolean],default:"body"}},setup(){return{isDarkTheme:qe()}},data(){return{avatarUrlLoaded:null,avatarSrcSetLoaded:null,userDoesNotExist:!1,isAvatarLoaded:!1,isMenuLoaded:!1,contactsMenuLoading:!1,contactsMenuData:{},contactsMenuActions:[],contactsMenuOpenState:!1}},computed:{avatarAriaLabel(){if(this.hasMenu)return this.canDisplayUserStatus||this.showUserStatusIconOnAvatar?y("Avatar of {displayName}, {status}",{displayName:this.displayName??this.user,status:_t(this.userStatus.status)}):y("Avatar of {displayName}",{displayName:this.displayName??this.user})},canDisplayUserStatus(){return!this.hideStatus&&this.showUserStatus&&this.hasStatus&&["online","away","busy","dnd"].includes(this.userStatus.status)},showUserStatusIconOnAvatar(){return!this.hideStatus&&this.showUserStatus&&!this.verboseStatus&&this.showUserStatusCompact&&this.hasStatus&&this.userStatus.status!=="dnd"&&this.userStatus.icon},userIdentifier(){return this.isDisplayNameDefined?this.displayName:this.isUserDefined?this.user:""},isUserDefined(){return typeof this.user<"u"},isDisplayNameDefined(){return typeof this.displayName<"u"},isUrlDefined(){return typeof this.url<"u"},hasMenu(){return this.disableMenu?!1:this.isMenuLoaded?this.menu.length>0:!(this.user===X()?.uid||this.userDoesNotExist||this.url)},showInitials(){return!this.noPlaceholder&&this.allowPlaceholder&&this.userDoesNotExist&&!(this.iconClass||this.$slots.icon)},avatarStyle(){return{"--avatar-size":this.size+"px",lineHeight:this.showInitials?this.size+"px":0,fontSize:Math.round(this.size*.45)+"px"}},initialsWrapperStyle(){const{r:t,g:e,b:s}=dt(this.userIdentifier);return{backgroundColor:`rgba(${t}, ${e}, ${s}, 0.1)`}},initialsStyle(){const{r:t,g:e,b:s}=dt(this.userIdentifier);return{color:`rgb(${t}, ${e}, ${s})`}},tooltip(){return this.disableTooltip?!1:this.tooltipMessage?this.tooltipMessage:this.displayName},initials(){let t="?";if(this.showInitials){const e=this.userIdentifier.trim();if(e==="")return t;const s=e.match(/[\p{L}\p{N}\s]/gu);if(s==null)return t;const a=s.join(""),l=a.lastIndexOf(" ");t=String.fromCodePoint(a.codePointAt(0)),l!==-1&&(t=t.concat(String.fromCodePoint(a.codePointAt(l+1))))}return t.toLocaleUpperCase()},menu(){const t=this.contactsMenuActions.map(s=>{const a=De(this.$router,s.hyperlink);return{ncActionComponent:a?pe:ce,ncActionComponentProps:a?{to:a,icon:s.icon}:{href:s.hyperlink,icon:s.icon},text:s.title}});for(const s of We(this.contactsMenuData))try{t.push({ncActionComponent:Vt,ncActionComponentProps:{},ncActionComponentHandlers:{click:()=>s.callback(this.contactsMenuData)},text:s.displayName(this.contactsMenuData),iconSvg:s.iconSvg(this.contactsMenuData)})}catch(a){Rt.error(`Failed to render ContactsMenu action ${s.id}`,{error:a,action:s})}function e(s){const a=document.createTextNode(s),l=document.createElement("p");return l.appendChild(a),l.innerHTML}if(!this.hideStatus&&this.showUserStatus&&(this.userStatus.icon||this.userStatus.message)){const s=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
					<text x="50%" y="50%" text-anchor="middle" style="dominant-baseline: central; font-size: 85%">${e(this.userStatus.icon)}</text>
				</svg>`;return[{ncActionComponent:ye,ncActionComponentProps:{},iconSvg:this.userStatus.icon?s:void 0,text:`${this.userStatus.message}`}].concat(t)}return t}},watch:{url(){this.userDoesNotExist=!1,this.loadAvatarUrl()},user(){this.userDoesNotExist=!1,this.isMenuLoaded=!1,this.loadAvatarUrl()}},mounted(){this.loadAvatarUrl(),O("settings:avatar:updated",this.loadAvatarUrl),O("settings:display-name:updated",this.loadAvatarUrl),!this.hideStatus&&this.showUserStatus&&this.user&&!this.isNoUser&&(this.preloadedUserStatus?(this.userStatus.status=this.preloadedUserStatus.status||"",this.userStatus.message=this.preloadedUserStatus.message||"",this.userStatus.icon=this.preloadedUserStatus.icon||"",this.hasStatus=this.preloadedUserStatus.status!==null):this.fetchUserStatus(this.user),O("user_status:status.updated",this.handleUserStatusUpdated))},beforeDestroy(){E("settings:avatar:updated",this.loadAvatarUrl),E("settings:display-name:updated",this.loadAvatarUrl),E("user_status:status.updated",this.handleUserStatusUpdated)},methods:{t:y,handleUserStatusUpdated(t){this.user===t.userId&&(this.userStatus={status:t.status,icon:t.icon,message:t.message},this.hasStatus=t.status!==null)},async toggleMenu(t){t.type==="keydown"&&t.key!=="Enter"||(this.contactsMenuOpenState||await this.fetchContactsMenu(),this.contactsMenuOpenState=!this.contactsMenuOpenState)},closeMenu(){this.contactsMenuOpenState=!1},async fetchContactsMenu(){this.contactsMenuLoading=!0;try{const t=encodeURIComponent(this.user),{data:e}=await R.post(gt("contactsmenu/findOne"),`shareType=0&shareWith=${t}`);this.contactsMenuData=e,this.contactsMenuActions=e.topAction?[e.topAction].concat(e.actions):e.actions}catch{this.contactsMenuOpenState=!1}this.contactsMenuLoading=!1,this.isMenuLoaded=!0},loadAvatarUrl(){if(this.isAvatarLoaded=!1,!this.isUrlDefined&&(!this.isUserDefined||this.isNoUser||this.iconClass)){this.isAvatarLoaded=!0,this.userDoesNotExist=!0;return}if(this.isUrlDefined){this.updateImageIfValid(this.url);return}if(this.size<=64){const t=this.avatarUrlGenerator(this.user,64),e=[t+" 1x",this.avatarUrlGenerator(this.user,512)+" 8x"].join(", ");this.updateImageIfValid(t,e)}else{const t=this.avatarUrlGenerator(this.user,512);this.updateImageIfValid(t)}},avatarUrlGenerator(t,e){let s=Xe(t,{size:e,isDarkTheme:this.isDarkTheme,isGuest:this.isGuest});return t===X()?.uid&&typeof oc_userconfig<"u"&&(s+="?v="+oc_userconfig.avatar.version),s},updateImageIfValid(t,e=null){const s=Ve(this.user);if(this.isUserDefined&&typeof s=="boolean"){this.isAvatarLoaded=!0,this.avatarUrlLoaded=t,e&&(this.avatarSrcSetLoaded=e),s===!1&&(this.userDoesNotExist=!0);return}const a=new Image;a.onload=()=>{this.avatarUrlLoaded=t,e&&(this.avatarSrcSetLoaded=e),this.isAvatarLoaded=!0,pt(this.user,!0)},a.onerror=()=>{console.debug("Invalid avatar url",t),this.avatarUrlLoaded=null,this.avatarSrcSetLoaded=null,this.userDoesNotExist=!0,this.isAvatarLoaded=!1,pt(this.user,!1)},e&&(a.srcset=e),a.src=t}}};var Ye=function(){var t=this,e=t._self._c;return e("span",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.closeMenu,expression:"closeMenu"}],staticClass:"avatardiv popovermenu-wrapper",class:{"avatardiv--unknown":t.userDoesNotExist,"avatardiv--with-menu":t.hasMenu,"avatardiv--with-menu-loading":t.contactsMenuLoading},style:t.avatarStyle,attrs:{title:t.tooltip}},[t._t("icon",function(){return[t.iconClass?e("span",{staticClass:"avatar-class-icon",class:t.iconClass}):t.isAvatarLoaded&&!t.userDoesNotExist?e("img",{attrs:{src:t.avatarUrlLoaded,srcset:t.avatarSrcSetLoaded,alt:""}}):t._e()]}),t.hasMenu&&t.menu.length===0?e("NcButton",{staticClass:"action-item action-item__menutoggle",attrs:{"aria-label":t.avatarAriaLabel,variant:"tertiary-no-background"},on:{click:t.toggleMenu},scopedSlots:t._u([{key:"icon",fn:function(){return[t.contactsMenuLoading?e("NcLoadingIcon"):e("IconDotsHorizontal",{attrs:{size:20}})]},proxy:!0}],null,!1,1269954734)}):t.hasMenu?e("NcActions",{attrs:{"aria-label":t.avatarAriaLabel,container:t.menuContainer,"force-menu":"","manual-open":"",open:t.contactsMenuOpenState,variant:"tertiary-no-background"},on:{"update:open":function(s){t.contactsMenuOpenState=s},click:t.toggleMenu},scopedSlots:t._u([t.contactsMenuLoading?{key:"icon",fn:function(){return[e("NcLoadingIcon")]},proxy:!0}:null],null,!0)},t._l(t.menu,function(s,a){return e(s.ncActionComponent,t._g(t._b({key:a,tag:"component",scopedSlots:t._u([s.iconSvg?{key:"icon",fn:function(){return[e("NcIconSvgWrapper",{attrs:{svg:s.iconSvg}})]},proxy:!0}:null],null,!0)},"component",s.ncActionComponentProps,!1),s.ncActionComponentHandlers),[t._v(" "+t._s(s.text)+" ")])}),1):t._e(),t.showUserStatusIconOnAvatar?e("span",{staticClass:"avatardiv__user-status avatardiv__user-status--icon"},[t._v(" "+t._s(t.userStatus.icon)+" ")]):t.canDisplayUserStatus?e("NcUserStatusIcon",{staticClass:"avatardiv__user-status",attrs:{status:t.userStatus.status,"aria-hidden":String(t.hasMenu)}}):t._e(),t.showInitials?e("span",{staticClass:"avatardiv__initials-wrapper",style:t.initialsWrapperStyle},[e("span",{staticClass:"avatardiv__initials",style:t.initialsStyle},[t._v(" "+t._s(t.initials)+" ")])]):t._e()],2)},Je=[],Ke=L(Re,Ye,Je,!1,null,"4c42c96e");const rs=Ke.exports;export{S as C,rs as N,ce as a,pe as b,as as d,Ze as u};
//# sourceMappingURL=NcAvatar-BEIBwiA6-D9O19u04.chunk.mjs.map
